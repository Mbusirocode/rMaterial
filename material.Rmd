---
title: "Introduction to R"
author: "dataCraft Lab "
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

- R is a free open source programming language for statistical computing and data visualization. 

- Created by **R**oss Ihaka and **R**obert Gentleman in 1992
 (University of Auckland, New Zealand).
 
- Yes, R stems from the first letter of their first names, inspired
by another programming language called S.

- R is useful when conducting statistical analysis and visualizations in different fields.

- Where there is a lot of data to wrangle, R is the best option.

## Why R? 
- **Open-source and accessible**:  R eliminates licensing costs and makes data management and visualization accessible to everyone.

- **Efficient data handling**: R excels at importing, cleaning, transforming, and organizing data through various packages and functions.

- **Flexibility and power**: R offers a diverse set of packages and functions, allowing you to create a wide variety of visualizations, from basic bar charts to complex interactive dashboards.

- **The Array of Packages**: Over 18,000 packages in the CRAN
repository, the number is constantly growing

- **Useful for Data wragling**: R offers a host of packages that help data analysts turn unstructured, messy data into a structured format.

* **Active community and support**: The vibrant R community provides a wealth of online resources, tutorials, and forums where you can find answers to your questions and connect with other users.

- **Customization and control**:You can personalize your visualizations to a high degree controlling every aspect of the visual elements, including colors, fonts, labels, layouts.

## R drawbacks
- **Weak Origin**: shares origin with old languages like S. Base
package does not have support for dynamic or 3D graphics

- **Data Handling**: physical memory stores the objects, hence
utilising more memory

- **Complicated Language**: R is not an easy language to learn.
It has a steep learning curve

- **Lesser Speed**: R packages and the R programming language is
much slower than other languages like MATLAB and Python

- **Spread Across various Packages**: The algorithms in R are
spread across different packages. Programmers without prior
knowledge of packages may find it difficult to implement
algorithms

## Introduction to R and R studio

- R Allows for rapid development of new tools according to user demand.

- These tools are distributed as packages, which any user can download to customize the R environment.

- Has an active Core Team, very large and active community of R- Users.


- Software and packages can be downloaded from
www.cran.r-project.org

- R Studio is an Integrated Development Environment(IDE) for R.

- At its simplest, R is like a car’s engine while RStudio is like a
car’s dashboard. 

- R Studio offers numerous helpful features:

1) A user-friendly interface

2) The ability to write and save reusable scripts

3) Easy access to all the imported data and created objects (like variables, functions, etc.)

4) Exhaustive help on any object

5) Code autocompletion

6) The ability to create projects to organize and share your work with your collaborators more efficiently

7) Plot previewing

8) Easy switching between terminal and console

9) Operational history tracking

## Getting started with R Studio

- Having installed R and RStudio on your computer, you have
two new programs (also called applications) you can open.

- To use RStudio, open it as you would open any program in
your computer. 

- Now that we have installed RStudio, lets take a couple minutes
to familiarize ourselves with the RStudio environment.

## *RStudio Panes*

 1. The **Source pane** is where you can edit and save R or Python scripts or author computational documents like Quarto and R Markdown.
 
 2. The **Console pane** is used to write short interactive R commands. There's also a history tab with a list of your prior commands.
 
 3. The **Environment pane** displays temporary R objects as created during that R session.
 
 4. The **Output pane** displays the plots, tables, or HTML outputs of executed code along with files saved to disk. 
 
```{r, echo=FALSE, fig.cap="Overview of R Studio", out.width = '100%'}
knitr::include_graphics("rstudio_panes.jpeg")
```

\textcolor{red}{Take note!}

- R is case-sensitive: That is, the name **AMR** in R will not be
the same as **amr** nor **Amr** nor **aMr** nor **amR**.

- Generally, we don’t work in the console, at least for writing
important codes. We use R script instead

- However, let’s take a few minutes to work with the console:

- Click on the console, just to the right of one of the “>”
prompts.

- We can use the console like a calculator. For example, type
13+45 at the prompt and hit enter.

- Now hit the “up” arrow. The R console remembers all previous
commands that it has executed in this session, which allows you
to re-run commands relatively easily.

- Any command that is preceded by a pound sign (#) is ignored
by the R console. 

- Try typing #2+2 and hitting “Enter”.
Nothing happens, right?

## Setting your working directory 

- Setting your working directory to let R know where to get all your files

- Change your working directory with the setwd() function

- setwd("~/mydirectory")

- setwd("E:/R projects")

## RStudio Projects
- RStudio projects make it straightforward to divide your work into multiple contexts, each with their own working directory, workspace, history, and source documents

- To create a new project in the RStudio, use the **File > New Project** command

- In the **New Project** wizard that pops up, select **New Directory**, then **New Project**. Name the project “hello” and then click the **Create Project** button

- This will launch you into a new RStudio Project inside a new folder called “hello”

- RStudio projects give you a solid workflow that will serve you well in the future:

   - Create an RStudio project for each data analysis project.
   
   - Keep data files there; we’ll talk about loading them into R in Local Data.
   
   - Keep scripts there; edit them, run them in bits or as a whole.
   
   - Save your outputs (plots and cleaned data) there.
   
- Everything you need is in one place, and cleanly separated from all the other projects that you are working on.



## Entering inputs into R

- The symbol <- is the assignment operator

- The # indicates a comment(i.e anything to the right is ignored)

## Evaluation of the input
- When a complete expression is typed into R and the code is run, you obtain an autoprinted output.

## How R Works I

- R creates its objects in memory and saves them in a single
file called .RData (by default)`

- Commands, recorded in a .Rhistory file may be recalled
and re-issued using up- and down-arrow

- Recalled commands may be edited

- Flawed commands may be abandoned by pressing Esc

- Copy-and-paste from a "file"

- Copy-and-paste from the history window used for recalling
several commands at once

- To end your session type q() or just kill the window.

## How R Works II

- There are a number of drop-down menus in the R Gui
(File, Edit, View, Packages, Help).

```{r, echo=FALSE, fig.cap="New file layout", out.width = '70%'}
knitr::include_graphics("newscript.png")
```
- To create a new R script in RStudio, click on the “blank paper”
icon at the far left of the RStudio toolbar (or File»New File»R
script).
- Input commands into R console window. When R is ready
for input, it prints out its prompt, a ">".

- Commands consist of expressions or assignments and are
separated by a semi-colon (;) or by a newline. They can be
grouped together using braces (f and g ) and comments
can be included and are indicated with a hash (#).

- Enter a line with a command after the prompt and press
Enter. The programme carries out the command and
prints the result if relevant.

- For example, if the expression is typed in, the following is printed in the R console:
```{r}
2+2 
```


- The prompt > indicates that R is ready for another
command. 

- If a command is incomplete at the end of a
line, the prompt + is displayed on subsequent lines until
the command is syntactically complete.

## Datasets: included in R
- A number of small datasets are included with R during installation. We might make use of one or more.
- There is no further installation required to access the included datasets.
- Command library loads the package MASS (for Modern Applied Statistics with S) into memory. **library(MASS)**
- Command **data()** will list all the datasets in loaded packages. 
- The command **data(phones)** will load the data set phones into memory


## R as a Calculator

- A basic but useful purpose of R is to perform simple
calculations
```{r}
# Addition and Subtraction
5 + 4

124 - 26.82

# Multiplication and Division
5 * 4

35/8

# Exponentials and Exponential Function: 

exp(-2)
```

## Saving and Loading Script

- Now that you have been able to write your first script in R, let
us save it and then quite RStudio. Ensure you remember where
you have saved the file.

- Open RStudio once more and try to locate the script file and
then open it once more for use.

## Variable names

The rules
- Can’t start with a number

- Made up of letters, numbers dots and underscores

 The guidelines
- Make the name mean something (x = bad, weight = good)

- Keep variables all lower case

- Separate words with dots or underscores

- gene_name or gene.name are the preferred options

## R Packages

- A set of functions designed to perform more specific statistical
or graphical tasks examples and documentation.
- 21,131+ packages found on the CRAN
- To use packages in R, download using install.packages()
or pacman::p_load()

## Working with R packages
- Base R and most R packages are available for download from
the CRAN

- base R comes with a number of basic data management,
analysis, and graphical tools (currently 15 base packages)

- However, R’s power and flexibility lie in its array of packages

- To learn more about a package eg. dplyr, one can check for
the reference manual using Rseek or use the code;

## Installing and using packages
-  To use packages in R, we must first install them using the
install.packages() or p_load function, which typically
downloads the package from CRAN and installs it for use.

- The command for installing a package is:
- install.packages("thepackagename")

- Example package installation using install.packages();

- install.packages("pacman")

- install.packages("pacman",quiet=TRUE)

- install.packages("pacman", dependencies=TRUE)

- Example: Try installing the package ggplot

## Loading R Packages
- Once the packages have been installed, we can load them in
the R environment using the functions library() or p_load().

- library() loads the packages only 

- pacman::p_load() is better and efficient, does the instalation
and loads the package.

- Functions and data structures within the package will then be
available for use.

- To use a package in your work once it's installed, load it with:
library("thepackagename")

- The following is an example of how we can load a package for
use in R

```{r}
## using the library function
library(MASS)
library(dplyr, quiet = TRUE)
## using p_load
#pacman::p_load(MASS, dplyr)
``` 

## Common R Packages

- In this section, we list and give details on some common
packages in R.

- Generally, these are some of the most popular and commonly
used packages.

- These packages do not have rankings in any order but are
provided here due to their functionalities and diverse
operations.

## Packages: Analyse & Explore

## tidyverse

- The core tidyverse includes the packages that you’re likely to use in
everyday data analyses. As of tidyverse 1.3.0, the following
packages are included in the core tidyverse: ggplot2, dplyr,
tidyr, readr, purrr, tibble, stringr and forcats. 
### Install from CRAN
```{r}
#install.packages("tidyverse")
```
### Usage
```{r}
library(tidyverse)
```
## dplyr

We use this library for performing data wrangling and data analysis.
The dplyr library facilitates several functions for the data frames in R

## purrr 

purrr enhances R’s functional programming (FP) toolkit by
providing a complete and consistent set of tools for working with
functions and vectors. 

## tidyr

As the name suggests, we use tidyr to make the data ‘tidy’. It works
well with dplyr. This is basically an evolution of the reshape2
package which is described later.

## ggplot2

With ggplot2, you can create graphics declaratively. ggplot2 is
famous for its elegant and quality graphs that sets it apart from
other visualization packages.

## stringr

A consistent, simple and easy-to-use set of wrappers around the
fantastic ‘stringi’ package.

## \textcolor{blue}{Exercise}

- install the following packages using the p_load function from
pacman package.

- MASS, ggplot2 , dplyr, tidyr

- Execute the following in a new r file called demo.R

```{r}
# Multiplying 3 by 4
3 * 4
# creating our first few objects
x <- 10 # Assigning the value 10 to the variable x
x # Calling the value assigned to x
y <- 2 # Assigning the value 2 to the variable x
z <- x/y # assigning the value z to x/y
z # calling z
a <- c(1:12)
# a>9 OR a<4 Gives us 1 2 3 10 11 12 Having R do this
a
a > 9
a < 4
a > 9 | a < 4
a[a > 9 | a < 4]
```

## Essentials of Programming

## Data types 


## Creating objects in R

* Objects in R, are what we call variables in other programming languages. They are instances of a class.
* R has these major classes of objects, character, numeric (real numbers), integer,complex
and logical (True/False)
* There is really only one rule about vectors in R, which is that**A vector can only contain objects of the same class**. 
* A vector, a matrix, a dataframe, a list, an array, or a factor are all objects in R. 

* R allows you to create various data objects to store and manipulate information. Here's an overview of some common objects and how to create them:

               1). Scalars :
   
```{r}
# Integer
age <- 25

# Double (floating-point number)
height <- 1.75

# Character string
name <- "John Doe"
```

---  
                 2). Vectors  :

Ordered collections of elements of the same data type. Create vectors using the c() function)(concatenating) or directly within parentheses.
```{r}
x <- c(0.5,0.9,0.7, 0.6) ## numeric
 x <- c(TRUE, FALSE) ## logical
x <- c(T, F) ## logical
 x <- c("a", "b", "c") ## character
``` 
         
               3). Matrices :
 Two-dimensional arrays of elements, typically of the same data type. Created using the matrix() function. Matrices are constructed column wise.
 
```{r}
# Numeric matrix
grades <- matrix(c(80, 95, 70, 90, 85, 65), nrow = 2,
                 ncol = 3)

# Character matrix
countries <- matrix(c("USA", "Canada",
                      "China", "France", "Germany","Kenya"), 
                    nrow = 2, ncol = 3)
countries 

```
Matrices can be created by column-binding or row-binding with the cbind() and rbind() functions.
```{r}
x <-c(1:3)
y <-c(10:12)
data1<-cbind(x, y)
data2<-rbind(x, y)
```
 
                4). Data Frames:
                
Tabular structures with columns of potentially different data types or different classes. Unlike matrices, data frames can store different classes of objects in each column.
package "dplyr" is used to work efficiently with data frames.
Created using the data.frame() function.
```{r}
# Sample data frame
dataFR <- data.frame(
  name = c("Alice", "Bob", "Charlie"),
  age = c(22, 30, 28),
  city = c("Nairobi", "Kisumu", "Kakamega")
)
dataFR

```
                
           5). Factors 
Factors are the data objects which are used to represent categorical data and store it on multiple levels. We can have either ordered and unordered factors.e factor function is used to create a factor.           Using factors with labels is better than using integers because factors are self-describing.
           
```{r}
gender_vector <- c("Male", "Female", "Female", "Male", "Male")
#Use the factor() function to convert the character vector into a factor variable

gender_factor <- factor(gender_vector, levels = c("Female", "Male"))
gender_factor
table(gender_factor)
```
 6). Lists :
           
A list in R is a generic object consisting of an ordered collection of objects. Lists are one-dimensional, different data classes. 

The list can be a list of vectors, a list of matrices, a list of characters and a list of functions, and so on. 

A list is a vector but with heterogeneous data elements. A list in R is created with the use of list() function.           
           
```{r}
# Create a list containing strings, numbers, vectors and a logical
# values.
list_data <- list("Red", "Green", c(21,32,11), TRUE, 51.23, 119.1)
print(list_data)
```
           7). Missing values
   Missing values are denoted by NA for values that are not available or NaN(not a number) or undefined mathematical operations.
• is.na() is used to test objects if they are NA
• is.nan() is used to test for NaN
• NA values have a class also, so there are integer NA, character NA, etc

* You can create an object using the “<-“ or an equals “=” sign. Both of these are used to assign values to objects. 

\textcolor{red}{NOTE}

There are a few rules to keep in mind while naming an object in R.

  * Object names should be short and explicit.
  
  * Object names cannot start with a number.
     
  * “Data” is different than “data” as R is case sensitive.
  
  * The names of default fundamental functions should not be used as object          names in R. eg: function, if, else, repeat, etc.
  
* **Tip** :  Choose meaningful names for your data objects to improve code readability. 

## Importing and exporting Data in R

\textcolor{blue}{Reading Data into R}

 * read.table, read.csv, for reading tabular data
 * readLines, for reading lines of a text file
 * source, for reading in R code files (inverse of dump)
* dget, for reading in R code files (inverse of dput)
* load, for reading in saved workspaces

## Reading Data Files with read.table()
* data <- read.table("location of your file,.txt") #if text file

* data <- read.csv("location of your file.csv") #if csv file

* for excel file, install the package "read.xl".

* library("readxl")

* my_data <- read_excel("myfile.xls")
# xlsx files
* my_data <- read_excel("myfile.xlsx")

## Subsetting objects in R
## Subsetting a Vector
objects in R and they can be subsetted using the [] operator
```{r}
x <- c(0.5,0.9,0.7,0.8,0.6)
x[2] ## Extract the second element
x[2:4] ##extract multiple elements of a vector by passing through an integer vector
x[c(1,3,5)] ##extract multiple elements of a vector through arbitrary integers
```
## Vectorized arithmetic
- A data vector is simply an array
of numbers, and a vector variable can be constructed like this.

- Suppose that we also have the heights that correspond to
the weights above. The body mass index (BMI) is defined
for each person as the weight in kilograms divided by the
square of the height in meters. This could be calculated as
follows:
```{r}
 weight <- c(30, 60, 72, 57, 40, 95, 72)
 height <- c(1.45, 1.75, 1.78, 1.65, 1.90, 1.74, 1.91)
  bmi <- weight/height^2
  mean(weight)
sd(weight)
plot(height,weight,pch=3)

```

## Getting help in R 

- R has a built-in help facility. To get more information on any specific function,
e.g. sqrt(), the command is help(sqrt) # or ? sqrt

- You can also obtain help on features specified by special characters, but they
must be enclosed in single or double quotes (e.g. "[[") help("[[")

- Help is also available in HTML format by running help.start()

- For more information use ? help

## Exercise

- Using the R inbuilt data set mtcars

- Take a first look at the data using the dimension, head, structure. Useful functions are dim(), head(), str()
and summary().
```{r}
data("mtcars")
dim(mtcars)
head(mtcars)
str(mtcars)
```

## Data Visualization
 - For simple plotting, use plot, hist, pairs, boxplot,...
– To add to existing plots, use points, lines, abline, legend, title,
mtext,...
– for Interacting with graphics, use locator, identify
– For three dimensional data, use contour, image, persp, 
```{r}
library(MASS) # loads MASS package
# Colour points and choose plotting symbols according to the
# levels of a factor
plot(Cars93$Weight, Cars93$EngineSize, col=as.numeric(Cars93$Type),pch=as.numeric(Cars93$Type))
# Adds x and y axes labels and a title.
plot(Cars93$Weight, Cars93$EngineSize, ylab="Engine Size",xlab="Weight", main="My plot")
# Add lines to the plot.
lines(x=c(min(Cars93$Weight), max(Cars93$Weight)), y=c(min(Cars93$EngineSize), max(Cars93$EngineSize)), lwd=4, lty=3, col="green")
abline(h=3, lty=2) # horizontal line
abline(v=1999, lty=4) # vertical line
```
```
